<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player Profiling Form - Beaverbrook 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/docx@7.8.2/build/index.min.js"></script>
</head>
<body class="bg-gray-100 font-sans">
    <div class="container mx-auto p-6 max-w-4xl">
        <h1 class="text-3xl font-bold text-center mb-6">Player Profiling Form – Beaverbrook 2025</h1>
        <form id="evaluationForm" class="space-y-8">
            <!-- Player Name Field -->
            <div class="bg-white p-4 rounded-lg shadow-md mb-6">
                <label for="playerName" class="block text-lg font-medium mb-2">Name or Nickname</label>
                <input type="text" id="playerName" name="playerName" required class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Enter your name or nickname">
            </div>

            <!-- Instructions -->
            <div class="bg-white p-4 rounded-lg shadow-md mb-6">
                <h2 class="text-xl font-semibold mb-2">Instructions</h2>
                <div class="text-sm text-gray-700">
                    <p><strong>Purpose:</strong> This form helps you honestly assess your rugby skills and attributes to identify strengths and areas for improvement, enhancing your contribution to the team. Be truthful—overestimating or underestimating your abilities won’t help you grow as a player.</p>
                    <p class="mt-2"><strong>Self-Evaluation:</strong> Rate yourself on each criterion based on your performance in recent games, practices, or scrimmages, using a scale of 1–5:</p>
                    <ul class="list-disc pl-5">
                        <li>1 = Developing skills, rarely effective or appropriate (room to improve to make the starting side).</li>
                        <li>2 = Average, sometimes effective but inconsistent (between 1 and 3 descriptors).</li>
                        <li>3 = Consistent, often effective and appropriate.</li>
                        <li>4 = Elite, always effective and appropriate (between 3 and 5 descriptors).</li>
                        <li>5 = Best in your division, consistently exceptional.</li>
                    </ul>
                    <p class="mt-2"><strong>Descriptors:</strong> For each criterion, read the descriptors for ratings 1, 3, and 5 to guide your self-assessment. Choose the rating that best matches your consistent performance, using 2 or 4 if you fall between descriptors.</p>
                    <p class="mt-2"><strong>Comments (optional):</strong> Add comments to justify your rating if desired (e.g., “Missed tackles in the last match due to poor positioning” or “Consistently won turnovers at rucks”). Focus on what you do regularly, not one-off moments. If unsure, consult your coach for perspective.</p>
                    <p class="mt-2"><strong>Tips for Honest Assessment:</strong></p>
                    <ul class="list-disc pl-5">
                        <li>Compare yourself to players in your division or team, not professionals.</li>
                        <li>Use specific examples from games or practices to support your rating.</li>
                        <li>Reflect on all areas, including Characteristics, as attitude and effort are as critical as skills.</li>
                    </ul>
                    <p class="mt-2"><strong>Submission:</strong> Complete the form by selecting a rating (1–5) for each criterion and adding comments if desired. Click “Download Responses” to save a Word document (.docx) and email it to your coach for review.</p>
                </div>
            </div>

            <!-- Tactical Attributes -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-semibold mb-4">Tactical Attributes</h2>
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-medium">1. Game Awareness</h3>
                        <p class="text-sm text-gray-600">Understands roles in attack and defense, applying principles of play (e.g., creating space, supporting play, or defending effectively).</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely understands roles in attack or defense, often out of position or unaware of team strategy.</p>
                            <p><strong>3:</strong> Sometimes understands roles, applies principles of play inconsistently, occasionally misreads situations.</p>
                            <p><strong>5:</strong> Consistently understands roles, always applies principles of play effectively in attack and defense.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="tactical1" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="tactical1" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="tactical1" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="tactical1" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="tactical1" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="tactical1_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">2. Decision-Making Under Pressure</h3>
                        <p class="text-sm text-gray-600">Makes quick, effective decisions in high-pressure situations during open play or set pieces.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely makes effective decisions under pressure, often panics or chooses poorly.</p>
                            <p><strong>3:</strong> Sometimes makes effective decisions under pressure, but consistency varies with game intensity.</p>
                            <p><strong>5:</strong> Always makes quick, effective decisions under pressure, maintaining composure in critical moments.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="tactical2" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="tactical2" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="tactical2" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="tactical2" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="tactical2" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="tactical2_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">3. Positioning</h3>
                        <p class="text-sm text-gray-600">Maintains optimal positioning to contribute to team strategy in attack (e.g., as a ball carrier, support, or decoy) and defense (e.g., joining breakdowns or maintaining defensive structure).</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely in the right position, often caught out in attack or defense, missing opportunities to contribute.</p>
                            <p><strong>3:</strong> Sometimes positions correctly, contributes to team strategy but occasionally out of alignment.</p>
                            <p><strong>5:</strong> Always in optimal position, consistently contributes to team strategy in attack and defense.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="tactical3" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="tactical3" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="tactical3" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="tactical3" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="tactical3" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="tactical3_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">4. Transition Effectiveness</h3>
                        <p class="text-sm text-gray-600">Adds continuity and excitement in attacking transitions (e.g., connecting before competing) and identifies/stops threats in defensive transitions.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely contributes to attacking transitions, struggles to identify or stop threats in defensive transitions.</p>
                            <p><strong>3:</strong> Sometimes adds continuity to attacking transitions and identifies defensive threats, but inconsistent.</p>
                            <p><strong>5:</strong> Always drives attacking transitions with excitement and continuity, consistently stops defensive threats.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="tactical4" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="tactical4" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="tactical4" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="tactical4" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="tactical4" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="tactical4_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">5. Rugby Literacy</h3>
                        <p class="text-sm text-gray-600">Demonstrates preparation and in-game influence by anticipating and leading key moments in a match.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely demonstrates preparation or influence, reacts to events without anticipation.</p>
                            <p><strong>3:</strong> Sometimes shows preparation and influences key moments, but impact is limited or inconsistent.</p>
                            <p><strong>5:</strong> Consistently demonstrates high preparation and leads key moments with strong in-game influence.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="tactical5" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="tactical5" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="tactical5" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="tactical5" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="tactical5" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="tactical5_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                </div>
            </div>

            <!-- Technical Attributes -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-semibold mb-4">Technical Attributes</h2>
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-medium">6. Ball Handling</h3>
                        <p class="text-sm text-gray-600">Catches and passes with soft hands, delivering the ball sympathetically under pressure (e.g., no bullet passes, effective distribution/re-distribution).</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely catches or passes effectively, struggles under pressure, often delivers bullet passes.</p>
                            <p><strong>3:</strong> Sometimes catches and passes with soft hands, inconsistent under pressure.</p>
                            <p><strong>5:</strong> Always catches and passes with soft hands, delivers sympathetically even under high pressure.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="technical1" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="technical1" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="technical1" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="technical1" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="technical1" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="technical1_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">7. Tackling Effectiveness</h3>
                        <p class="text-sm text-gray-600">Executes tackles with proper form, achieving high completion rates (aim for 85–90% success) and winning turnovers when possible.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely completes tackles effectively, misses often, and rarely wins turnovers.</p>
                            <p><strong>3:</strong> Sometimes completes tackles with proper form, achieves moderate success rate (60–70%), occasionally wins turnovers.</p>
                            <p><strong>5:</strong> Consistently completes tackles with proper form, achieves high success rate (85–90%), often wins turnovers.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="technical2" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="technical2" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="technical2" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="technical2" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="technical2" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="technical2_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">8. Kicking Accuracy</h3>
                        <p class="text-sm text-gray-600">Performs kicks (e.g., grubber, chip, box, or long kicks) accurately for territory, possession, or attack.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely executes accurate kicks, often misses targets or loses possession.</p>
                            <p><strong>3:</strong> Sometimes executes accurate kicks, achieves moderate success in gaining territory or possession.</p>
                            <p><strong>5:</strong> Always executes accurate kicks, consistently gains territory or possession with precision.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="technical3" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="technical3" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="technical3" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="technical3" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="technical3" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="technical3_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">9. Breakdown Skills</h3>
                        <p class="text-sm text-gray-600">Effectively secures or contests possession at rucks and mauls with proper technique.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely secures or contests possession effectively, often penalized or ineffective at breakdowns.</p>
                            <p><strong>3:</strong> Sometimes secures or contests possession with proper technique, but inconsistent in effectiveness.</p>
                            <p><strong>5:</strong> Always secures or contests possession with excellent technique, consistently effective at breakdowns.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="technical4" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="technical4" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="technical4" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="technical4" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="technical4" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="technical4_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">10. Set Piece Execution</h3>
                        <p class="text-sm text-gray-600">Performs functional roles in scrums and lineouts (e.g., providing a stable platform, disrupting opposition, or accurate throwing/feeding) effectively in attack and defense.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely effective in set piece roles, struggles with technique or fails to contribute to stability/disruption.</p>
                            <p><strong>3:</strong> Sometimes effective in set piece roles, contributes inconsistently to stability or disruption.</p>
                            <p><strong>5:</strong> Always highly effective in set piece roles, consistently provides stability or disrupts opposition.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="technical5" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="technical5" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="technical5" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="technical5" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="technical5" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="technical5_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                </div>
            </div>

            <!-- Physical Attributes -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-semibold mb-4">Physical Attributes</h2>
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-medium">11. Strength and Power</h3>
                        <p class="text-sm text-gray-600">Possesses adequate strength and power (e.g., upper body, core, legs) to win collisions, rucks, and tackles, and prevent injuries.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Often loses collisions, rucks, and tackles due to lack of strength and power, prone to injuries.</p>
                            <p><strong>3:</strong> Sometimes wins collisions, rucks, and tackles with adequate strength, but inconsistent.</p>
                            <p><strong>5:</strong> Consistently wins collisions, rucks, and tackles with elite strength and power, rarely loses contact situations.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="physical1" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="physical1" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="physical1" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="physical1" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="physical1" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="physical1_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">12. Speed and Acceleration</h3>
                        <p class="text-sm text-gray-600">Moves quickly to exploit gaps, chase kicks, or retreat in defense, with strong acceleration to break away or chase down opponents.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Lacks speed/acceleration, struggles to exploit gaps or chase opponents, often exposed defensively.</p>
                            <p><strong>3:</strong> Adequate speed/acceleration, sometimes exploits gaps or chases effectively, but fatigues late in games.</p>
                            <p><strong>5:</strong> Elite speed/acceleration, regularly breaks away or chases down opponents, effective even when fatigued.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="physical2" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="physical2" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="physical2" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="physical2" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="physical2" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="physical2_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">13. Agility and Mobility</h3>
                        <p class="text-sm text-gray-600">Demonstrates quick footwork, sidestepping, or swerving to evade opponents or maneuver effectively in attack and defense.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely demonstrates agility, struggles to evade opponents or maneuver effectively.</p>
                            <p><strong>3:</strong> Sometimes shows agility, can evade opponents or maneuver but inconsistent in execution.</p>
                            <p><strong>5:</strong> Always demonstrates elite agility, consistently evades opponents and maneuvers effectively.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="physical3" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="physical3" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="physical3" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="physical3" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="physical3" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="physical3_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">14. Conditioning</h3>
                        <p class="text-sm text-gray-600">Sustains high-intensity performance throughout matches and competition weekends, with minimal drop-off in technical skills or decision-making when fatigued (e.g., aim for 4:45–5:25 min on the Bronco test).</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Unable to sustain moderate intensity for half a match, technical skills and decisions degrade when fatigued.</p>
                            <p><strong>3:</strong> Sustains high intensity for full games but fatigues over weekends, maintains moderate skills when tired.</p>
                            <p><strong>5:</strong> Elite conditioning, sustains high intensity across matches and weekends, skills and decisions unaffected by fatigue.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="physical4" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="physical4" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="physical4" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="physical4" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="physical4" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="physical4_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                </div>
            </div>

            <!-- Characteristics -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-semibold mb-4">Characteristics</h2>
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-medium">15. Mental Toughness</h3>
                        <p class="text-sm text-gray-600">Maintains focus and resilience under adverse conditions or high-pressure situations.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely maintains focus or resilience, easily discouraged under pressure or adversity.</p>
                            <p><strong>3:</strong> Sometimes maintains focus and resilience, but wavers in challenging situations.</p>
                            <p><strong>5:</strong> Always maintains focus and resilience, thrives under pressure and adversity.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="characteristics1" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="characteristics1" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="characteristics1" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="characteristics1" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="characteristics1" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="characteristics1_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">16. Performance Under Pressure</h3>
                        <p class="text-sm text-gray-600">Performs consistently and effectively in critical moments, managing nerves and maintaining composure.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely performs effectively in critical moments, often overwhelmed by nerves.</p>
                            <p><strong>3:</strong> Sometimes performs effectively in critical moments, but nerves impact consistency.</p>
                            <p><strong>5:</strong> Always performs effectively in critical moments, consistently composed under pressure.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="characteristics2" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="characteristics2" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="characteristics2" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="characteristics2" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="characteristics2" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="characteristics2_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">17. Communication</h3>
                        <p class="text-sm text-gray-600">Communicates clearly with teammates to align strategies and coordinate plays.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely communicates effectively, struggles to align with teammates or coordinate plays.</p>
                            <p><strong>3:</strong> Sometimes communicates clearly, but inconsistent in aligning strategies or coordinating plays.</p>
                            <p><strong>5:</strong> Always communicates clearly, consistently aligns strategies and coordinates plays with teammates.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="characteristics3" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="characteristics3" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="characteristics3" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="characteristics3" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="characteristics3" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="characteristics3_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                    <div>
                        <h3 class="text-lg font-medium">18. Effort and Competitiveness</h3>
                        <p class="text-sm text-gray-600">Displays relentless effort, a never-quit attitude, and consistent competitiveness in matches and practices, thriving in challenging situations.</p>
                        <div class="text-sm text-gray-700 mt-2">
                            <p><strong>1:</strong> Rarely shows effort or competitiveness, lacks determination in matches or practices.</p>
                            <p><strong>3:</strong> Sometimes shows effort and competitiveness, but motivation or focus drops in challenging situations.</p>
                            <p><strong>5:</strong> Consistently displays relentless effort and competitiveness, thrives in challenging situations with a never-quit attitude.</p>
                        </div>
                        <div class="flex space-x-4 mt-2">
                            <label><input type="radio" name="characteristics4" value="1" class="mr-1"> 1</label>
                            <label><input type="radio" name="characteristics4" value="2" class="mr-1"> 2</label>
                            <label><input type="radio" name="characteristics4" value="3" class="mr-1"> 3</label>
                            <label><input type="radio" name="characteristics4" value="4" class="mr-1"> 4</label>
                            <label><input type="radio" name="characteristics4" value="5" class="mr-1"> 5</label>
                        </div>
                        <textarea name="characteristics4_comment" placeholder="Comments (optional, to justify rating if desired)" class="w-full p-2 mt-2 border border-gray-300 rounded-lg" rows="4"></textarea>
                    </div>
                </div>
            </div>

            <div class="text-center">
                <button type="button" id="downloadBtn" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700">Download Responses</button>
            </div>
        </form>
    </div>

    <script>
        document.getElementById('downloadBtn').addEventListener('click', () => {
            try {
                const form = document.getElementById('evaluationForm');
                const playerName = document.getElementById('playerName').value.trim();
                const ratings = {};
                let isComplete = true;

                // Validate player name
                if (!playerName) {
                    alert('Please enter your name or nickname.');
                    return;
                }

                // Collect ratings for Tactical Attributes
                for (let i = 1; i <= 5; i++) {
                    const rating = form.querySelector(`input[name="tactical${i}"]:checked`);
                    const comment = form.querySelector(`textarea[name="tactical${i}_comment"]`).value.trim();
                    if (!rating) {
                        isComplete = false;
                        alert(`Please provide a rating for Tactical Attribute #${i}.`);
                        return;
                    }
                    ratings[`tactical${i}`] = parseInt(rating.value);
                    ratings[`tactical${i}_comment`] = comment;
                }

                // Collect ratings for Technical Attributes
                for (let i = 1; i <= 5; i++) {
                    const rating = form.querySelector(`input[name="technical${i}"]:checked`);
                    const comment = form.querySelector(`textarea[name="technical${i}_comment"]`).value.trim();
                    if (!rating) {
                        isComplete = false;
                        alert(`Please provide a rating for Technical Attribute #${i}.`);
                        return;
                    }
                    ratings[`technical${i}`] = parseInt(rating.value);
                    ratings[`technical${i}_comment`] = comment;
                }

                // Collect ratings for Physical Attributes
                for (let i = 1; i <= 4; i++) {
                    const rating = form.querySelector(`input[name="physical${i}"]:checked`);
                    const comment = form.querySelector(`textarea[name="physical${i}_comment"]`).value.trim();
                    if (!rating) {
                        isComplete = false;
                        alert(`Please provide a rating for Physical Attribute #${i}.`);
                        return;
                    }
                    ratings[`physical${i}`] = parseInt(rating.value);
                    ratings[`physical${i}_comment`] = comment;
                }

                // Collect ratings for Characteristics
                for (let i = 1; i <= 4; i++) {
                    const rating = form.querySelector(`input[name="characteristics${i}"]:checked`);
                    const comment = form.querySelector(`textarea[name="characteristics${i}_comment"]`).value.trim();
                    if (!rating) {
                        isComplete = false;
                        alert(`Please provide a rating for Characteristic #${i}.`);
                        return;
                    }
                    ratings[`characteristics${i}`] = parseInt(rating.value);
                    ratings[`characteristics${i}_comment`] = comment;
                }

                if (isComplete) {
                    // Calculate totals
                    ratings.playerName = playerName;
                    const total = Object.values(ratings)
                        .filter(val => typeof val === 'number')
                        .reduce((sum, val) => sum + val, 0);
                    ratings.total = total;
                    ratings.decimal = (total / 90).toFixed(2); // Max score: 18 criteria * 5 = 90
                    ratings.percent = ((total / 90) * 100).toFixed(2);

                    // Create DOCX document
                    const doc = new docx.Document({
                        sections: [{
                            properties: {},
                            children: [
                                new docx.Paragraph({
                                    text: "Player Profiling Form – Beaverbrook 2025",
                                    heading: docx.HeadingLevel.HEADING_1,
                                    alignment: docx.AlignmentType.CENTER,
                                    spacing: { after: 200 }
                                }),
                                new docx.Paragraph({
                                    text: `Player Name: ${playerName}`,
                                    heading: docx.HeadingLevel.HEADING_2,
                                    spacing: { after: 200 }
                                }),
                                new docx.Paragraph({
                                    text: "Instructions",
                                    heading: docx.HeadingLevel.HEADING_2,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "This form assesses your rugby skills and attributes. Ratings range from 1 (Developing) to 5 (Best in division). Comments are optional to justify ratings.",
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "Tactical Attributes",
                                    heading: docx.HeadingLevel.HEADING_2,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "1. Game Awareness",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Understands roles in attack and defense, applying principles of play (e.g., creating space, supporting play, or defending effectively).",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.tactical1} (${ratings.tactical1 === 1 ? "Developing" : ratings.tactical1 === 2 ? "Average" : ratings.tactical1 === 3 ? "Consistent" : ratings.tactical1 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.tactical1_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "2. Decision-Making Under Pressure",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Makes quick, effective decisions in high-pressure situations during open play or set pieces.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.tactical2} (${ratings.tactical2 === 1 ? "Developing" : ratings.tactical2 === 2 ? "Average" : ratings.tactical2 === 3 ? "Consistent" : ratings.tactical2 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.tactical2_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "3. Positioning",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Maintains optimal positioning to contribute to team strategy in attack (e.g., as a ball carrier, support, or decoy) and defense (e.g., joining breakdowns or maintaining defensive structure).",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.tactical3} (${ratings.tactical3 === 1 ? "Developing" : ratings.tactical3 === 2 ? "Average" : ratings.tactical3 === 3 ? "Consistent" : ratings.tactical3 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.tactical3_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "4. Transition Effectiveness",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Adds continuity and excitement in attacking transitions (e.g., connecting before competing) and identifies/stops threats in defensive transitions.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.tactical4} (${ratings.tactical4 === 1 ? "Developing" : ratings.tactical4 === 2 ? "Average" : ratings.tactical4 === 3 ? "Consistent" : ratings.tactical4 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.tactical4_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "5. Rugby Literacy",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Demonstrates preparation and in-game influence by anticipating and leading key moments in a match.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.tactical5} (${ratings.tactical5 === 1 ? "Developing" : ratings.tactical5 === 2 ? "Average" : ratings.tactical5 === 3 ? "Consistent" : ratings.tactical5 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.tactical5_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "Technical Attributes",
                                    heading: docx.HeadingLevel.HEADING_2,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "6. Ball Handling",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Catches and passes with soft hands, delivering the ball sympathetically under pressure (e.g., no bullet passes, effective distribution/re-distribution).",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.technical1} (${ratings.technical1 === 1 ? "Developing" : ratings.technical1 === 2 ? "Average" : ratings.technical1 === 3 ? "Consistent" : ratings.technical1 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.technical1_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "7. Tackling Effectiveness",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Executes tackles with proper form, achieving high completion rates (aim for 85–90% success) and winning turnovers when possible.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.technical2} (${ratings.technical2 === 1 ? "Developing" : ratings.technical2 === 2 ? "Average" : ratings.technical2 === 3 ? "Consistent" : ratings.technical2 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.technical2_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "8. Kicking Accuracy",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Performs kicks (e.g., grubber, chip, box, or long kicks) accurately for territory, possession, or attack.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.technical3} (${ratings.technical3 === 1 ? "Developing" : ratings.technical3 === 2 ? "Average" : ratings.technical3 === 3 ? "Consistent" : ratings.technical3 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.technical3_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "9. Breakdown Skills",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Effectively secures or contests possession at rucks and mauls with proper technique.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.technical4} (${ratings.technical4 === 1 ? "Developing" : ratings.technical4 === 2 ? "Average" : ratings.technical4 === 3 ? "Consistent" : ratings.technical4 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.technical4_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "10. Set Piece Execution",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Performs functional roles in scrums and lineouts (e.g., providing a stable platform, disrupting opposition, or accurate throwing/feeding) effectively in attack and defense.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.technical5} (${ratings.technical5 === 1 ? "Developing" : ratings.technical5 === 2 ? "Average" : ratings.technical5 === 3 ? "Consistent" : ratings.technical5 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.technical5_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "Physical Attributes",
                                    heading: docx.HeadingLevel.HEADING_2,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "11. Strength and Power",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Possesses adequate strength and power (e.g., upper body, core, legs) to win collisions, rucks, and tackles, and prevent injuries.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.physical1} (${ratings.physical1 === 1 ? "Developing" : ratings.physical1 === 2 ? "Average" : ratings.physical1 === 3 ? "Consistent" : ratings.physical1 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.physical1_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "12. Speed and Acceleration",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Moves quickly to exploit gaps, chase kicks, or retreat in defense, with strong acceleration to break away or chase down opponents.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.physical2} (${ratings.physical2 === 1 ? "Developing" : ratings.physical2 === 2 ? "Average" : ratings.physical2 === 3 ? "Consistent" : ratings.physical2 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.physical2_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "13. Agility and Mobility",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Demonstrates quick footwork, sidestepping, or swerving to evade opponents or maneuver effectively in attack and defense.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.physical3} (${ratings.physical3 === 1 ? "Developing" : ratings.physical3 === 2 ? "Average" : ratings.physical3 === 3 ? "Consistent" : ratings.physical3 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.physical3_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "14. Conditioning",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Sustains high-intensity performance throughout matches and competition weekends, with minimal drop-off in technical skills or decision-making when fatigued (e.g., aim for 4:45–5:25 min on the Bronco test).",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.physical4} (${ratings.physical4 === 1 ? "Developing" : ratings.physical4 === 2 ? "Average" : ratings.physical4 === 3 ? "Consistent" : ratings.physical4 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.physical4_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "Characteristics",
                                    heading: docx.HeadingLevel.HEADING_2,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "15. Mental Toughness",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Maintains focus and resilience under adverse conditions or high-pressure situations.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.characteristics1} (${ratings.characteristics1 === 1 ? "Developing" : ratings.characteristics1 === 2 ? "Average" : ratings.characteristics1 === 3 ? "Consistent" : ratings.characteristics1 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.characteristics1_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "16. Performance Under Pressure",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Performs consistently and effectively in critical moments, managing nerves and maintaining composure.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.characteristics2} (${ratings.characteristics2 === 1 ? "Developing" : ratings.characteristics2 === 2 ? "Average" : ratings.characteristics2 === 3 ? "Consistent" : ratings.characteristics2 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.characteristics2_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "17. Communication",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Communicates clearly with teammates to align strategies and coordinate plays.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.characteristics3} (${ratings.characteristics3 === 1 ? "Developing" : ratings.characteristics3 === 2 ? "Average" : ratings.characteristics3 === 3 ? "Consistent" : ratings.characteristics3 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.characteristics3_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "18. Effort and Competitiveness",
                                    heading: docx.HeadingLevel.HEADING_3
                                }),
                                new docx.Paragraph({
                                    text: "Displays relentless effort, a never-quit attitude, and consistent competitiveness in matches and practices, thriving in challenging situations.",
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Rating: ${ratings.characteristics4} (${ratings.characteristics4 === 1 ? "Developing" : ratings.characteristics4 === 2 ? "Average" : ratings.characteristics4 === 3 ? "Consistent" : ratings.characteristics4 === 4 ? "Elite" : "Best in division"})`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Comment: ${ratings.characteristics4_comment || "None"}`,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: "Summary",
                                    heading: docx.HeadingLevel.HEADING_2,
                                    spacing: { after: 100 }
                                }),
                                new docx.Paragraph({
                                    text: `Total Score: ${ratings.total} / 90`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Decimal: ${ratings.decimal}`,
                                    spacing: { after: 50 }
                                }),
                                new docx.Paragraph({
                                    text: `Percent: ${ratings.percent}%`,
                                    spacing: { after: 50 }
                                })
                            ]
                        }]
                    });

                    // Generate and download the DOCX file
                    docx.Packer.toBlob(doc).then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        const safeName = playerName.replace(/[^a-zA-Z0-9_-]/g, '_');
                        a.download = `${safeName}_Profiling_Form_2025.docx`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        window.URL.revokeObjectURL(url);
                    });
                }
            } catch (error) {
                console.error('Error generating DOCX:', error);
                alert('An error occurred while generating the file. Please try again or contact your coach.');
            }
        });
    </script>
</body>
</html>